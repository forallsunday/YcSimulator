综合光电系统仿真模块成像驱动功能

【涉及功能单元】

综合光电仿真、成像仿真软件

【功能概述】

成像仿真根据综合光电生成的成像驱动数据生成单张图像，并将成像驱动数据中的注释信息作为图像注释信息，与仿真生成的图像一同传给数管。

成像仿真根据成像驱动参数中综合光电检测出的动目标信息将图像的目标坐标数据转发给综合光电，综合光电再将该数据转发给ICP用于中屏监视界面目标跟踪框显示。

**表1综合光电成像功能仿真消息接口定义**

| 话题名称             | 话题标识              | 接口类型 | 周期 | 共用数据引用                                                                     | 事件触发条件       |
| -------------------- | --------------------- | -------- | ---- | -------------------------------------------------------------------------------- | ------------------ |
| 综合光电成像驱动参数 | SecEOImageDriveMsg    | 事件     | \-   | 包头+成像状态+显示区域参数+图像注释信息+光电图像调节参数+动目标检测成像参数\[5\] | 每次拍照刷新一次   |
| 目标像素数据         | SecTgtPositionParaMsg | 事件     | \-   | 包头+动目标像素坐标参数\[5\]                                                     | 收到成像驱动数据后 |

（一）综合光电成像驱动过程

标识：EOImageState

**表2 成像状态数据定义**

| **数据定义** | **标识**     | **单位** | **数据长度** | **数据类型** | **数值说明**                                                                                             |
| ------------ | ------------ | -------- | ------------ | ------------ | -------------------------------------------------------------------------------------------------------- |
| 传感器状态   | U1_IRSensor  | \-       | 1            | Octet        | 0-NA，1-可见光，2-红外，3-可见+红外，4-红外+可见<br><br>成像响应：不同传感器状态对应不同像源、图像分辨率 |
| 视频状态     | U1_TVState   | \-       | 1            | Octet        | 视频/图像标识位，用于区域监视状态下区分视频下传与图像下传<br><br>0-NA，1-图像，2-视频                    |
| 成像模式     | U1_ImageMode |          | 1            | Octet        | 0-NA，1-广域成像，2-区域成像，3-区域监视<br><br>不同成像模式对应不同图像分辨率                           |

标识：EOImageShowArea

**表2 显示区域参数数据定义**

| **数据定义** | **标识**               | **单位** | **数据长度** | **数据类型** | **数值说明** |
| ------------ | ---------------------- | -------- | ------------ | ------------ | ------------ |
| 视线方位角   | F4_AZLOS_deg_BODY      | deg      | 4            | float        | \[-180,180\] |
| 视线俯仰角   | F4_ELLOS_deg_BODY      | deg      | 4            | float        | \[-90,90\]   |
| 水平范围     | F4_horizontalCover_deg | deg      | 4            | float        | \[0,180\]    |
| 垂直范围     | F4_verticalCover_deg   | deg      | 4            | float        | \[0,180\]    |

标识：EOImageParasIS

**表2 光电图像注释信息图像参数数据定义**

| 数据定义         | 标识                   | 单位 | 数据长度 | 数据类型             | 数值说明                                                                                                                                                                       |
| ---------------- | ---------------------- | ---- | -------- | -------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 图像时间         | St_ImageTime           |      | 8        | Timestamp            | 图像时间，包含年月日、时分秒、毫秒                                                                                                                                             |
| 图像帧序号       | U4_ImgId               |      | 4        | unsigned long        | 图像总序号（可见光/红外分开计数）。每次帧号改变重新生成一张图                                                                                                                  |
| 光电周期号       | U2_EOCycleNo           |      | 2        | unsigned short       | \[0,65535\]<br><br>完成一次规定收容宽度的摆扫定义为一个周期（从1开始），（区域监视每张图片为一个周期）<br><br>用于成像仿真填写作为附加在光电图像的图像注释信息并转发给数管单元 |
| 条带号           | U2_LineNo              | \-   | 2        | unsigned short       | \[0,65536\]<br><br>广域/区域成像：在一次区域成像（一个周期内），一次摆扫（左到右或右到左），叫做一个条带号。区域监视使用固定值01                                               |
| 条带内序号       | U2_EO_LineNo           | \-   | 2        | unsigned short       | \[0,65536\]<br><br>表示一次摆扫左到右或右到左）过程每张图片的编号（从1开始），区域监视使用固定值01                                                                             |
| 图像行数         | U4_ImageLineNum        |      | 4        | unsigned long        | \[0,99999\]，垂直于航向的像素个数                                                                                                                                              |
| 图像列数         | U4_ImageColumnNum      |      | 4        | unsigned long        | \[0,99999\]，平行于航向的像素个数                                                                                                                                              |
| 收容宽度         | U4_WideCover           | m    | 4        | unsigned long        | 广域模式和区域成像模式下垂直航向的实际宽度，区域监视模式下为一帧图像的实际宽度                                                                                                 |
| 视场中心_俯仰    | F4_ELLOS_deg_BODY      | deg  | 4        | float                | \[-90,90\]                                                                                                                                                                     |
| 视场中心_方位    | F4_AZLOS_deg_BODY      | deg  | 4        | float                | \[-180,180\]                                                                                                                                                                   |
| 视场大小_俯仰    | F4_verticalCover_deg   | deg  | 4        | float                | \[0,180\]                                                                                                                                                                      |
| 视场大小_方位    | F4_horizontalCover_deg | deg  | 4        | float                | \[0,180\]                                                                                                                                                                      |
| 航向重叠率       | U1_CouseTgtCover       |      | 1        | octet                | \[0,99\],像素百分比,平行飞行方向两帧图像的重叠率                                                                                                                               |
| 傍向重叠率       | U1_BesideTgtCover      |      | 1        | octet                | \[0,99\],百分比,垂直飞行方向两帧图像的重叠率                                                                                                                                   |
| 像元分辨率       | U2_CurResolution       | m    | 2        | unsigned short       | LSB 0.01<br><br>\[00.00,99.99\],像面投影中心位置分辨率（综合光电计算值，精度与飞机姿态参数精度、相对高度参数精度等相关）                                                       |
| 地面摄影分辨率   | U2_GroundResolution    | m    | 2        | unsigned short       | LSB 0.01<br><br>\[00.00,99.99\],像面投影中心位置地面摄影分辨率。像元投影到地面后的分辨率。精度与飞机姿态参数精度、相对高度参数精度等相关                                       |
| 图像中心经纬高   | St_ImgCenterPosition   |      | 20       | Position             | 图像中心对应的经纬高度                                                                                                                                                         |
| 图像左上角经纬度 | St_ImgLeftUp           |      | 16       | Longlat              | 图像左上角经纬度                                                                                                                                                               |
| 图像左下角经纬度 | St_ImgLeftDown         |      | 16       | Longlat              | 图像左下角经纬度                                                                                                                                                               |
| 图像右上角经纬度 | St_ImgRightUp          |      | 16       | Longlat              | 图像右上角经纬度                                                                                                                                                               |
| 图像右下角经纬度 | St_ImgRightDown        |      | 16       | Longlat              | 图像右下角经纬度                                                                                                                                                               |
| 照相次数         | U2_TakeTimes           |      | 2        | unsigned short       | \[0,999\] 每次接收拍照指令或模式变换时+1                                                                                                                                       |
| 相机焦距         | U2_FocalLength         | mm   | 2        | unsigned short       | 0~65535，毫米,相机焦距参数，光电独有                                                                                                                                           |
| 曝光时间         | U2_ExposureTime        | us   | 2        | unsigned short       | 000~999，图像曝光时间，分辨率为1微秒                                                                                                                                           |
| 重要目标标识     | U1_ImpotentTag         |      | 1        | octet                | 0-不重要目标，1-重要目标，2-未知                                                                                                                                               |
| 成像中心经纬度   | St_ImgCenter           |      | 16       | Longlat              | 成像中心经纬度                                                                                                                                                                 |
| 载机信息         | St_AcParas             |      | 56       | EntityPosVelAccAtt   | 载机信息                                                                                                                                                                       |
| 图像任务信息     | Seq_Mission            |      | 20       | sequence&lt;char&gt; | 图像任务信息注释信息                                                                                                                                                           |

标识：EOImageModifyPara

**表**3 **光电图像调节参数数据定义**

| 数据定义     | 标识                   | 字节数 | 数据类型 | 数值说明                     |
| ------------ | ---------------------- | ------ | -------- | ---------------------------- |
| 可见光调光值 | I1_LightValueLight     | 1      | char     | \[-127,127\]<br><br>调光级别 |
| 可见光调焦值 | I1_FocusValueLight     | 1      | char     | \[-127,127\]<br><br>调焦级别 |
| 可见光去雾   | U1_LightMistEliminate  | 1      | octet    | 0-NA，1-ON，2-OFF            |
| 可见光增强   | U1_LightEnhance_Mode   | 1      | octet    | 0-NA，1-ON，2-OFF            |
| 红外调光值   | I1_LightValueInfrared  | 1      | char     | \[-127,127\]<br><br>调光级别 |
| 红外调焦值   | I1_FocusValueInfrared  | 1      | char     | \[-127,127\]<br><br>调焦级别 |
| 极化         | U1_VideoPolar          | 1      | octet    | 0-NA，1-黑热，2-白热         |
| 红外增强     | U1_InfraredEnhanceMode | 1      | octet    | 0-NA，1-ON，2-OFF            |

标识：EOTgtPara

**表**4**动目标检测成像参数数据定义**

| 数据定义     | 标识        | 单位 | 数据类型 | 数值说明         |
| ------------ | ----------- | ---- | -------- | ---------------- |
| 检测目标编号 | St_EntityID | \-   | EntityID | 可检测目标的编号 |

（二）成像仿真发送给综合光电的数据

功能概述：成像根据综合光电发送的动目标检测成像参数返回相应的像素坐标数据。

标识：EOTgtPositionPara

**表**5 **动目标像素坐标参数数据定义**

| 数据定义               | 标识              | 字节数 | 数据类型       | 数值说明                                                                                     |
| ---------------------- | ----------------- | ------ | -------------- | -------------------------------------------------------------------------------------------- |
| 目标左上角横向像素坐标 | U2_Tgt1UpleftX    | 2      | unsigned short | \[0,65535\]<br><br>无有效目标时默认填0<br><br>动目标的四角坐标像素定义，以图像左下角为原点。 |
| 目标左上角纵向像素坐标 | U2_Tgt1UpleftY    | 2      | unsigned short | \[0,65535\]<br><br>无有效目标时默认填0<br><br>动目标的四角坐标像素定义，以图像左下角为原点。 |
| 目标右下角横向像素坐标 | U2_Tgt1DownrightX | 2      | unsigned short | \[0,65535\]<br><br>无有效目标时默认填0<br><br>动目标的四角坐标像素定义，以图像左下角为原点。 |
| 目标右下角纵向像素坐标 | U2_Tgt1DownrightY | 2      | unsigned short | \[0,65535\]<br><br>无有效目标时默认填0<br><br>动目标的四角坐标像素定义，以图像左下角为原点。 |